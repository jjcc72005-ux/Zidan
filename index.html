<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
<title>Zidan Flags Quiz</title>

<style>
:root {
  --accent: #00ffff;
  --bg1: #050c1c;
  --bg2: #0b1e2b;
  --correct: #00c853;
  --wrong: #ff1744;
}
body {
  margin:0;
  font-family:"Cairo",sans-serif;
  background: radial-gradient(circle at top, var(--bg1), var(--bg2));
  color:#fff;
  height:100vh;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}
header {
  position:fixed;
  top:10px;
  right:15px;
  display:flex;
  align-items:center;
  gap:8px;
  font-weight:700;
  font-size:1.2em;
  color:var(--accent);
  text-shadow:0 0 10px var(--accent);
}
header img {
  width:28px;
  height:28px;
}
#game {
  background:rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.1);
  border-radius:15px;
  box-shadow:0 0 25px rgba(0,255,255,0.15);
  padding:20px;
  width:90%;
  max-width:420px;
  text-align:center;
}
#flag {
  width:220px;
  height:140px;
  border-radius:10px;
  margin:15px auto;
  box-shadow:0 0 15px rgba(0,255,255,0.3);
  display:none;
  transition:all 0.4s ease;
}
.options {
  display:flex;
  flex-direction:column;
  gap:10px;
}
button.option {
  background:rgba(0,0,0,0.4);
  border:1px solid rgba(255,255,255,0.2);
  border-radius:8px;
  color:#fff;
  padding:10px;
  font-size:1em;
  cursor:pointer;
  transition:0.3s;
}
button.option:hover { background:rgba(255,255,255,0.1); }
.score {
  position:fixed;
  top:10px;
  left:15px;
  font-weight:700;
  color:var(--accent);
  font-size:1.2em;
  text-shadow:0 0 10px var(--accent);
}
.fade {
  animation:fadein 0.6s ease;
}
@keyframes fadein {
  from {opacity:0; transform:scale(0.9);}
  to {opacity:1; transform:scale(1);}
}
</style>
</head>
<body>
<header>
  <span>ZIDAN Quiz</span>
  <img src="https://cdn-icons-png.flaticon.com/512/1975/1975637.png" alt="logo">
</header>
<div class="score" id="score">النتيجة: 0</div>
<div id="game">
  <img id="flag" src="" alt="Flag">
  <div class="options" id="options"></div>
</div>

<script>
const flagEl=document.getElementById('flag');
const optionsEl=document.getElementById('options');
const scoreEl=document.getElementById('score');
let countries=[],used=[],score=0;

async function loadCountries(){
  try{
    const res=await fetch("https://restcountries.com/v3.1/all");
    const data=await res.json();
    countries=data.filter(c=>c.flags && c.name && c.name.common);
    startGame();
  }catch(e){
    alert("حدث خطأ في تحميل الأعلام، أعد المحاولة.");
  }
}

function startGame(){
  nextRound();
}

function nextRound(){
  if(used.length===countries.length){
    alert("🎉 خلصت كل الأعلام! نتيجتك: "+score);
    used=[]; score=0;
    scoreEl.textContent="النتيجة: 0";
  }
  let rand;
  do { rand=Math.floor(Math.random()*countries.length); }
  while(used.includes(rand));
  used.push(rand);

  const correct=countries[rand];
  flagEl.src=correct.flags.png || correct.flags.svg;
  flagEl.style.display='block';
  flagEl.classList.add("fade");

  setTimeout(()=>{
    flagEl.style.display='none';
    showOptions(correct);
  },1000);
}

function showOptions(correct){
  optionsEl.innerHTML='';
  const correctName=correct.name.common;
  const opts=[correctName];
  while(opts.length<3){
    const randName=countries[Math.floor(Math.random()*countries.length)].name.common;
    if(!opts.includes(randName)) opts.push(randName);
  }
  opts.sort(()=>Math.random()-0.5);
  opts.forEach(name=>{
    const btn=document.createElement('button');
    btn.textContent=name;
    btn.className='option fade';
    btn.onclick=()=>{
      if(name===correctName){
        btn.style.background='var(--correct)';
        score++;
        scoreEl.textContent="النتيجة: "+score;
      } else {
        btn.style.background='var(--wrong)';
      }
      disableAll();
      setTimeout(nextRound,1000);
    };
    optionsEl.appendChild(btn);
  });
}
function disableAll(){
  document.querySelectorAll('.option').forEach(b=>b.disabled=true);
}

window.addEventListener('load',loadCountries);
</script>
</body>
</html>
